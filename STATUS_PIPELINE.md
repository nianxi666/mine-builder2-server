# ğŸš€ å¢é‡è®­ç»ƒç®¡é“çŠ¶æ€

## å½“å‰è¿è¡ŒçŠ¶æ€ (2024-10-27 23:33)

### âœ… æœ¬åœ°æ•°æ®ç”Ÿæˆ (è¿è¡Œä¸­)
```
è¿›ç¨‹: python3 generate_premium_dataset.py
PID: 34232
çŠ¶æ€: âœ… è¿è¡Œä¸­
è¿›åº¦: 1/500 æ ·æœ¬ (0.2%)
é¢„è®¡æ—¶é—´: ~14å°æ—¶ (100ç§’/æ ·æœ¬)
è¾“å‡º: /home/engine/project/dataset_gemini/
æ¨¡å‹: gemini-2.0-flash-thinking-exp-1219
```

### âš ï¸ æ•°æ®åŒæ­¥ (éƒ¨åˆ†å·¥ä½œ)
```
è¿›ç¨‹: sync_dataset.sh
PID: 34097
çŠ¶æ€: âš ï¸  è¿è¡Œä½†æœ‰é”™è¯¯
é—®é¢˜: rsyncåè®®ä¸åŒ¹é…
å·²åŒæ­¥: 1ä¸ªæ ·æœ¬å°è¯•åŒæ­¥ï¼ˆä½†å¤±è´¥ï¼‰
```

**ä¿®å¤æ–¹æ¡ˆ**: ä½¿ç”¨scpä»£æ›¿rsync

### â³ è¿œç¨‹è®­ç»ƒ (ç­‰å¾…æ•°æ®)
```
çŠ¶æ€: â³ ç­‰å¾…å¯åŠ¨
éœ€è¦: æœ€å°‘50ä¸ªæ ·æœ¬æ‰èƒ½å¼€å§‹
å½“å‰: 0ä¸ªæ ·æœ¬åœ¨è¿œç¨‹
é¢„è®¡å¼€å§‹: ~80åˆ†é’Ÿå
```

## ğŸ“Š ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æœ¬åœ°æœºå™¨ (å¯è®¿é—®API) â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     â”‚
â”‚ 1. Gemini API       â”‚â”€â”€ç”Ÿæˆâ”€â”€â”
â”‚    æ•°æ®ç”Ÿæˆ         â”‚        â”‚
â”‚    (generate_       â”‚        â–¼
â”‚     premium_        â”‚   dataset_gemini/
â”‚     dataset.py)     â”‚   â”œâ”€â”€ sample_0000/
â”‚                     â”‚   â”œâ”€â”€ sample_0001/
â”‚ 2. æ•°æ®åŒæ­¥         â”‚â—„â”€ç›‘æ§â”€â”¤
â”‚    (sync_dataset    â”‚        â”‚
â”‚     .sh)            â”‚        â”‚
â”‚                     â”‚â”€â”€åŒæ­¥â”€â”€â–¼
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   SSH/SCP
          â”‚                   â”‚
          â”‚                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¿œç¨‹GPUæœåŠ¡å™¨ (æ— æ³•è®¿é—®API)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚
â”‚ 3. å¢é‡è®­ç»ƒ                      â”‚
â”‚    (train_incremental.py)      â”‚
â”‚                                 â”‚
â”‚    â”œâ”€â”€ ç›‘æ§dataset_live/        â”‚
â”‚    â”œâ”€â”€ æ£€æµ‹æ–°æ ·æœ¬               â”‚
â”‚    â”œâ”€â”€ åŠ¨æ€åŠ è½½åˆ°DataLoader     â”‚
â”‚    â””â”€â”€ æŒç»­è®­ç»ƒ                 â”‚
â”‚                                 â”‚
â”‚ 4. æ¯10æ­¥æ¨ç†                   â”‚
â”‚    éªŒè¯è®­ç»ƒæ•ˆæœ                 â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ å½“å‰é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### é—®é¢˜1: rsyncåè®®ä¸åŒ¹é… âŒ
**ç°è±¡**: 
```
protocol version mismatch -- is your shell clean?
rsync error: protocol incompatibility (code 2)
```

**åŸå› **: è¿œç¨‹SSHæ¬¢è¿æ¶ˆæ¯å¹²æ‰°rsyncåè®®

**è§£å†³æ–¹æ¡ˆ**: æ”¹ç”¨scpæ‰¹é‡ä¼ è¾“

```bash
# åœæ­¢å½“å‰åŒæ­¥
kill $(cat dataset_sync.pid)

# ä½¿ç”¨æ–°çš„åŒæ­¥è„šæœ¬
bash sync_dataset_scp.sh &
```

### é—®é¢˜2: è¿œç¨‹è®­ç»ƒæœªå¯åŠ¨ â³
**åŸå› **: éœ€è¦50ä¸ªæ ·æœ¬æ‰èƒ½å¼€å§‹ï¼Œä½†åŒæ­¥å¤±è´¥å¯¼è‡´è¿œç¨‹æ²¡æœ‰æ•°æ®

**è§£å†³æ–¹æ¡ˆ**: ä¿®å¤åŒæ­¥åä¼šè‡ªåŠ¨å¼€å§‹

## ğŸ“ˆ é¢„è®¡æ—¶é—´çº¿

```
ç°åœ¨ (23:33)
  â”‚
  â”œâ”€â”€ 1ä¸ªæ ·æœ¬å·²ç”Ÿæˆ
  â”‚
+1å°æ—¶ (00:33)
  â”‚
  â”œâ”€â”€ 36ä¸ªæ ·æœ¬
  â”‚
+1.5å°æ—¶ (01:03) â† 50ä¸ªæ ·æœ¬ï¼
  â”‚
  â”œâ”€â”€ âœ… è¿œç¨‹è®­ç»ƒè‡ªåŠ¨å¯åŠ¨
  â”‚   - åˆå§‹è®­ç»ƒ (50æ ·æœ¬)
  â”‚   - æ¯åˆ†é’Ÿæ£€æµ‹æ–°æ•°æ®
  â”‚   - åŠ¨æ€æ‰©å±•æ•°æ®é›†
  â”‚
+6å°æ—¶ (05:33)
  â”‚
  â”œâ”€â”€ 216ä¸ªæ ·æœ¬
  â”œâ”€â”€ è®­ç»ƒè¿›è¡Œä¸­
  â”‚
+14å°æ—¶ (13:33æ˜å¤©)
  â”‚
  â”œâ”€â”€ 500ä¸ªæ ·æœ¬å…¨éƒ¨ç”Ÿæˆ
  â””â”€â”€ è®­ç»ƒä½¿ç”¨å®Œæ•´æ•°æ®é›†
```

## ğŸ¯ ç«‹å³è¡ŒåŠ¨

### 1. ä¿®å¤åŒæ­¥è„šæœ¬

åˆ›å»ºæ–°çš„SCPåŒæ­¥ï¼š

```bash
# åœæ­¢æ—§åŒæ­¥
kill $(cat dataset_sync.pid)

# åˆ›å»ºæ–°åŒæ­¥è„šæœ¬
cat > sync_dataset_scp.sh << 'EOF'
#!/bin/bash
REMOTE="root4563@root@ssh-06aace8d2b864475e7b3e2eb54a8107e.zlrast8j3bxb@direct.virtaicloud.com"
PASSWORD="liu20062020"
LOCAL_DIR="/home/engine/project/dataset_gemini"
REMOTE_DIR="/gemini/code/dataset_live"

while true; do
    LOCAL_SAMPLES=$(ls -d $LOCAL_DIR/sample_* 2>/dev/null | wc -l)
    REMOTE_SAMPLES=$(sshpass -p "$PASSWORD" ssh -p 30022 -o StrictHostKeyChecking=no "$REMOTE" "ls -d $REMOTE_DIR/sample_* 2>/dev/null | wc -l" 2>&1 | tail -1)
    
    if [ $LOCAL_SAMPLES -gt ${REMOTE_SAMPLES:-0} ]; then
        echo "[$(date '+%H:%M:%S')] åŒæ­¥ $LOCAL_SAMPLES -> $REMOTE_SAMPLES"
        sshpass -p "$PASSWORD" scp -P 30022 -o StrictHostKeyChecking=no -r $LOCAL_DIR/sample_* "$REMOTE:$REMOTE_DIR/" 2>&1 | tail -3
    fi
    
    sleep 60
done
EOF

# å¯åŠ¨
nohup bash sync_dataset_scp.sh > dataset_sync_scp.log 2>&1 &
echo $! > dataset_sync_scp.pid
```

### 2. æ‰‹åŠ¨è§¦å‘è¿œç¨‹è®­ç»ƒå¯åŠ¨

```bash
# æ£€æŸ¥è¿œç¨‹æ•°æ®
sshpass -p 'liu20062020' ssh -p 30022 root4563@root@ssh-06aace8d2b864475e7b3e2eb54a8107e.zlrast8j3bxb@direct.virtaicloud.com "ls /gemini/code/dataset_live/ | wc -l"

# ä¸€æ—¦æœ‰50+æ ·æœ¬ï¼Œå¯åŠ¨è®­ç»ƒ
sshpass -p 'liu20062020' ssh -p 30022 root4563@root@ssh-06aace8d2b864475e7b3e2eb54a8107e.zlrast8j3bxb@direct.virtaicloud.com "cd /gemini/code/upload_package && bash start_incremental_remote.sh"
```

### 3. ç›‘æ§è¿›åº¦

```bash
# æœ¬åœ°ç›‘æ§
bash monitor_status.sh

# æˆ–æŸ¥çœ‹æ—¥å¿—
tail -f gemini_generation.log        # æ•°æ®ç”Ÿæˆ
tail -f dataset_sync_scp.log          # æ•°æ®åŒæ­¥

# è¿œç¨‹ç›‘æ§
sshpass -p 'liu20062020' ssh -p 30022 root4563@root@ssh-06aace8d2b864475e7b3e2eb54a8107e.zlrast8j3bxb@direct.virtaicloud.com "screen -r training_live"
```

## ğŸ“ å…³é”®æŒ‡æ ‡

### æ•°æ®ç”Ÿæˆé€Ÿåº¦
- **å½“å‰**: 100ç§’/æ ·æœ¬
- **ç›®æ ‡**: 500æ ·æœ¬
- **é¢„è®¡**: 13.9å°æ—¶

### è®­ç»ƒé€Ÿåº¦ï¼ˆåŸºäºä¹‹å‰ç»éªŒï¼‰
- **æ¨¡å‹**: Small (32.7Må‚æ•°)
- **Batch size**: 8
- **é€Ÿåº¦**: 2-4 it/s
- **100æ ·æœ¬**: ~10åˆ†é’Ÿ/epoch

### é¢„æœŸç»“æœ
- **åˆå§‹**: 50æ ·æœ¬å¼€å§‹è®­ç»ƒ
- **ä¸­æœŸ**: æ¯å°æ—¶æ–°å¢36ä¸ªæ ·æœ¬ï¼Œé€æ­¥æ‰©å±•
- **æœ€ç»ˆ**: 500æ ·æœ¬å®Œæ•´è®­ç»ƒ

## ğŸ’¡ ä¼˜åŠ¿

è¿™ä¸ªå¢é‡ç®¡é“çš„ä¼˜åŠ¿ï¼š

1. **ä¸æµªè´¹æ—¶é—´**: æ•°æ®ç”Ÿæˆçš„åŒæ—¶å°±å¼€å§‹è®­ç»ƒ
2. **åŠ¨æ€æ‰©å±•**: æ¨¡å‹æŒç»­å­¦ä¹ æ›´å¤šæ ·æœ¬
3. **èµ„æºä¼˜åŒ–**: æœ¬åœ°ç”Ÿæˆæ•°æ®ï¼Œè¿œç¨‹GPUä¸“æ³¨è®­ç»ƒ
4. **å¯ç›‘æ§**: å®Œæ•´çš„æ—¥å¿—å’ŒçŠ¶æ€ç›‘æ§

## ğŸš¨ æ³¨æ„äº‹é¡¹

1. âš ï¸  **åŒæ­¥å¿…é¡»å·¥ä½œ**: å¦åˆ™è¿œç¨‹æ— æ³•è·å–æ•°æ®
2. âš ï¸  **APIé…é¢**: ç¡®ä¿Gemini APIä¸ä¼šè€—å°½é…é¢
3. âš ï¸  **ç£ç›˜ç©ºé—´**: 500æ ·æœ¬çº¦éœ€è¦500MBç©ºé—´
4. âš ï¸  **ç½‘ç»œç¨³å®š**: SSHè¿æ¥éœ€è¦ä¿æŒç¨³å®š

---

**ä¸‹ä¸€æ­¥**: ç«‹å³ä¿®å¤åŒæ­¥è„šæœ¬ï¼Œç¡®ä¿æ•°æ®èƒ½æ­£ç¡®ä¼ è¾“åˆ°è¿œç¨‹ï¼
